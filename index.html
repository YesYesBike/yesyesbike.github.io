<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>/home/yesyesbike/personal/projects/han_c/han.c</title>
<meta name="colorscheme" content="yin"></meta>
<style>
* {font-family: monospace; font-size: 21px}
body {background-color: #1c1c1c; color: #bcbcbc}
.String {color: #9e9e9e}
.PreProc {color: #808080}
.Statement {font-weight: bold; color: #666666}
.Number {color: #767676}
.Type {font-weight: bold; color: #666666}
.Special {color: #666666}
.Comment {color: #4e4e4e; font-style: italic}
.Constant {font-weight: bold; color: #666666}
</style>
</head>
<body style="display: flex">
<pre>
<span class="PreProc">#include </span><span class="String">&quot;han.h&quot;</span>

<span class="Type">char</span> han_table[] = {
    <span class="Number">7</span>,  <span class="Number">37</span>, <span class="Number">15</span>, <span class="Number">12</span>, <span class="Number">5</span>,  <span class="Number">6</span>,  <span class="Number">19</span>,  <span class="Number">28</span>, <span class="Number">22</span>, <span class="Number">24</span>, <span class="Number">20</span>, <span class="Number">40</span>, <span class="Number">38</span>, <span class="Number">33</span>, <span class="Number">23</span>,
    <span class="Number">27</span>, <span class="Number">9</span>,  <span class="Number">2</span>,  <span class="Number">3</span>,  <span class="Number">11</span>, <span class="Number">26</span>, <span class="Number">18</span>,  <span class="Number">14</span>, <span class="Number">17</span>, <span class="Number">32</span>, <span class="Number">16</span>, <span class="Number">70</span>, <span class="Number">70</span>, <span class="Number">70</span>, <span class="Number">70</span>,
    <span class="Number">70</span>, <span class="Number">70</span>, <span class="Number">7</span>,  <span class="Number">37</span>, <span class="Number">15</span>, <span class="Number">12</span>, <span class="Number">4</span>,   <span class="Number">6</span>,  <span class="Number">19</span>, <span class="Number">28</span>, <span class="Number">22</span>, <span class="Number">24</span>, <span class="Number">20</span>, <span class="Number">40</span>, <span class="Number">38</span>,
    <span class="Number">33</span>, <span class="Number">21</span>, <span class="Number">25</span>, <span class="Number">8</span>,  <span class="Number">1</span>,  <span class="Number">3</span>,  <span class="Number">10</span>,  <span class="Number">26</span>, <span class="Number">18</span>, <span class="Number">13</span>, <span class="Number">17</span>, <span class="Number">32</span>, <span class="Number">16</span>
};

<span class="Type">void</span> han_print_p(han_reg *reg)
{
    <span class="Statement">if</span> (reg-&gt;p == <span class="Number">0</span>)
        <span class="Statement">return</span>;
    putwchar(reg-&gt;p);
    reg-&gt;p = <span class="Number">0</span>;
}


<span class="Type">void</span> han_trans(<span class="Type">char</span> chr, han_reg *reg)
{
    <span class="Statement">switch</span> (chr) {
    <span class="Statement">case</span> <span class="Constant">'r'</span>:    <span class="Comment">/* ㄱ */</span>
    <span class="Statement">case</span> <span class="Constant">'R'</span>:    <span class="Comment">/* ㄲ */</span>
    <span class="Statement">case</span> <span class="Constant">'s'</span>:    <span class="Comment">/* ㄴ */</span>
    <span class="Statement">case</span> <span class="Constant">'S'</span>:    <span class="Comment">/* ㄴ */</span>
    <span class="Statement">case</span> <span class="Constant">'e'</span>:    <span class="Comment">/* ㄷ */</span>
    <span class="Statement">case</span> <span class="Constant">'E'</span>:    <span class="Comment">/* ㄸ */</span>
    <span class="Statement">case</span> <span class="Constant">'f'</span>:    <span class="Comment">/* ㄹ */</span>
    <span class="Statement">case</span> <span class="Constant">'F'</span>:    <span class="Comment">/* ㄹ */</span>
    <span class="Statement">case</span> <span class="Constant">'a'</span>:    <span class="Comment">/* ㅁ */</span>
    <span class="Statement">case</span> <span class="Constant">'A'</span>:    <span class="Comment">/* ㅁ */</span>
    <span class="Statement">case</span> <span class="Constant">'q'</span>:    <span class="Comment">/* ㅂ */</span>
    <span class="Statement">case</span> <span class="Constant">'Q'</span>:    <span class="Comment">/* ㅃ */</span>
    <span class="Statement">case</span> <span class="Constant">'t'</span>:    <span class="Comment">/* ㅅ */</span>
    <span class="Statement">case</span> <span class="Constant">'T'</span>:    <span class="Comment">/* ㅆ */</span>
    <span class="Statement">case</span> <span class="Constant">'d'</span>:    <span class="Comment">/* ㅇ */</span>
    <span class="Statement">case</span> <span class="Constant">'D'</span>:    <span class="Comment">/* ㅇ */</span>
    <span class="Statement">case</span> <span class="Constant">'w'</span>:    <span class="Comment">/* ㅈ */</span>
    <span class="Statement">case</span> <span class="Constant">'W'</span>:    <span class="Comment">/* ㅉ */</span>
    <span class="Statement">case</span> <span class="Constant">'c'</span>:    <span class="Comment">/* ㅊ */</span>
    <span class="Statement">case</span> <span class="Constant">'C'</span>:    <span class="Comment">/* ㅊ */</span>
    <span class="Statement">case</span> <span class="Constant">'z'</span>:    <span class="Comment">/* ㅋ */</span>
    <span class="Statement">case</span> <span class="Constant">'Z'</span>:    <span class="Comment">/* ㅋ */</span>
    <span class="Statement">case</span> <span class="Constant">'x'</span>:    <span class="Comment">/* ㅌ */</span>
    <span class="Statement">case</span> <span class="Constant">'X'</span>:    <span class="Comment">/* ㅌ */</span>
    <span class="Statement">case</span> <span class="Constant">'v'</span>:    <span class="Comment">/* ㅍ */</span>
    <span class="Statement">case</span> <span class="Constant">'V'</span>:    <span class="Comment">/* ㅍ */</span>
    <span class="Statement">case</span> <span class="Constant">'g'</span>:    <span class="Comment">/* ㅎ */</span>
    <span class="Statement">case</span> <span class="Constant">'G'</span>:    <span class="Comment">/* ㅎ */</span>
        han_ja(chr, reg);
        <span class="Statement">break</span>;

    <span class="Statement">case</span> <span class="Constant">'k'</span>:    <span class="Comment">/* ㅏ */</span>
    <span class="Statement">case</span> <span class="Constant">'K'</span>:    <span class="Comment">/* ㅏ */</span>
    <span class="Statement">case</span> <span class="Constant">'o'</span>:    <span class="Comment">/* ㅐ */</span>
    <span class="Statement">case</span> <span class="Constant">'i'</span>:    <span class="Comment">/* ㅑ */</span>
    <span class="Statement">case</span> <span class="Constant">'I'</span>:    <span class="Comment">/* ㅑ */</span>
    <span class="Statement">case</span> <span class="Constant">'O'</span>:    <span class="Comment">/* ㅒ */</span>
    <span class="Statement">case</span> <span class="Constant">'j'</span>:    <span class="Comment">/* ㅓ */</span>
    <span class="Statement">case</span> <span class="Constant">'J'</span>:    <span class="Comment">/* ㅓ */</span>
    <span class="Statement">case</span> <span class="Constant">'p'</span>:    <span class="Comment">/* ㅔ */</span>
    <span class="Statement">case</span> <span class="Constant">'u'</span>:    <span class="Comment">/* ㅕ */</span>
    <span class="Statement">case</span> <span class="Constant">'U'</span>:    <span class="Comment">/* ㅕ */</span>
    <span class="Statement">case</span> <span class="Constant">'P'</span>:    <span class="Comment">/* ㅖ */</span>
    <span class="Statement">case</span> <span class="Constant">'h'</span>:    <span class="Comment">/* ㅗ */</span>
    <span class="Statement">case</span> <span class="Constant">'H'</span>:    <span class="Comment">/* ㅗ */</span>
    <span class="Statement">case</span> <span class="Constant">'y'</span>:    <span class="Comment">/* ㅛ */</span>
    <span class="Statement">case</span> <span class="Constant">'Y'</span>:    <span class="Comment">/* ㅛ */</span>
    <span class="Statement">case</span> <span class="Constant">'n'</span>:    <span class="Comment">/* ㅜ */</span>
    <span class="Statement">case</span> <span class="Constant">'N'</span>:    <span class="Comment">/* ㅜ */</span>
    <span class="Statement">case</span> <span class="Constant">'b'</span>:    <span class="Comment">/* ㅠ */</span>
    <span class="Statement">case</span> <span class="Constant">'B'</span>:    <span class="Comment">/* ㅠ */</span>
    <span class="Statement">case</span> <span class="Constant">'m'</span>:    <span class="Comment">/* ㅡ */</span>
    <span class="Statement">case</span> <span class="Constant">'M'</span>:    <span class="Comment">/* ㅡ */</span>
    <span class="Statement">case</span> <span class="Constant">'l'</span>:    <span class="Comment">/* ㅣ */</span>
    <span class="Statement">case</span> <span class="Constant">'L'</span>:    <span class="Comment">/* ㅣ */</span>
        han_mo(chr, reg);
        <span class="Statement">break</span>;

    <span class="Statement">case</span> <span class="Constant">'['</span>:
    <span class="Statement">case</span> <span class="Special">'\\'</span>:
    <span class="Statement">case</span> <span class="Constant">']'</span>:
    <span class="Statement">case</span> <span class="Constant">'^'</span>:
    <span class="Statement">case</span> <span class="Constant">'_'</span>:
    <span class="Statement">case</span> <span class="Constant">'`'</span>:
        han_insert_p(reg);
        han_print_p(reg);
        putwchar(chr);
    }
}


<span class="Type">void</span> han_insert_p(han_reg *reg)
{
    <span class="Type">unsigned</span> checksum = (reg-&gt;cho) + (reg-&gt;jung) + (reg-&gt;jong);
    <span class="Statement">if</span> (checksum == <span class="Number">0</span>)
        <span class="Statement">return</span>;
    
    <span class="Statement">if</span> (reg-&gt;cho == checksum)
        han_cho_p(reg);
    <span class="Statement">else</span> <span class="Statement">if</span> (reg-&gt;jung == checksum)
        reg-&gt;p = <span class="Number">0x313B</span> + reg-&gt;jung;    <span class="Comment">//0x314F~0x3163</span>
    <span class="Statement">else</span>
        han_combine_p(reg);

    reg-&gt;cho = <span class="Number">0</span>;
    reg-&gt;jung = <span class="Number">0</span>;
    reg-&gt;jong = <span class="Number">0</span>;
}


<span class="Type">void</span> han_combine_p(han_reg *reg)
{
    <span class="Statement">if</span> (reg-&gt;jong != <span class="Number">0</span>)
        han_jong_p(reg);

    (reg-&gt;cho)--;
    reg-&gt;jung -= <span class="Number">20</span>;

    reg-&gt;p = <span class="Number">0xAC00</span> + (<span class="Number">588</span>*reg-&gt;cho) + (<span class="Number">28</span>*reg-&gt;jung) + reg-&gt;jong;
}


<span class="Type">void</span> han_cho_p(han_reg *reg)
{
    <span class="Statement">switch</span> (reg-&gt;cho) {
    <span class="Statement">case</span> <span class="Number">1</span>:
    <span class="Statement">case</span> <span class="Number">2</span>:
        reg-&gt;cho -= <span class="Number">1</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">41</span>:                    <span class="Comment">/* ㄳ */</span>
        reg-&gt;cho = <span class="Number">2</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">3</span>:
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">42</span>:                    <span class="Comment">/* ㄵ */</span>
    <span class="Statement">case</span> <span class="Number">43</span>:                    <span class="Comment">/* ㄶ */</span>
        reg-&gt;cho -= <span class="Number">38</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">4</span>:
    <span class="Statement">case</span> <span class="Number">5</span>:
    <span class="Statement">case</span> <span class="Number">6</span>:
        reg-&gt;cho += <span class="Number">2</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">44</span>:                    <span class="Comment">/* ㄺ */</span>
    <span class="Statement">case</span> <span class="Number">45</span>:                    <span class="Comment">/* ㄻ */</span>
    <span class="Statement">case</span> <span class="Number">46</span>:                    <span class="Comment">/* ㄼ */</span>
    <span class="Statement">case</span> <span class="Number">47</span>:                    <span class="Comment">/* ㄽ */</span>
    <span class="Statement">case</span> <span class="Number">48</span>:                    <span class="Comment">/* ㄾ */</span>
    <span class="Statement">case</span> <span class="Number">49</span>:                    <span class="Comment">/* ㄿ */</span>
    <span class="Statement">case</span> <span class="Number">50</span>:                    <span class="Comment">/* ㅀ */</span>
        reg-&gt;cho -= <span class="Number">35</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">7</span>:
    <span class="Statement">case</span> <span class="Number">8</span>:
    <span class="Statement">case</span> <span class="Number">9</span>:
        reg-&gt;cho += <span class="Number">9</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">51</span>:                    <span class="Comment">/* ㅄ */</span>
        reg-&gt;cho = <span class="Number">19</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">10</span>:
    <span class="Statement">case</span> <span class="Number">11</span>:
    <span class="Statement">case</span> <span class="Number">12</span>:
    <span class="Statement">case</span> <span class="Number">13</span>:
    <span class="Statement">case</span> <span class="Number">14</span>:
    <span class="Statement">case</span> <span class="Number">15</span>:
    <span class="Statement">case</span> <span class="Number">16</span>:
    <span class="Statement">case</span> <span class="Number">17</span>:
    <span class="Statement">case</span> <span class="Number">18</span>:
    <span class="Statement">case</span> <span class="Number">19</span>:
        reg-&gt;cho += <span class="Number">10</span>;
    }

    reg-&gt;p = <span class="Number">0x3131</span> + reg-&gt;cho;        <span class="Comment">//0x3131~0x314E</span>
}


<span class="Type">void</span> han_jong_p(han_reg *reg)
{
    <span class="Statement">switch</span> (reg-&gt;jong) {
    <span class="Statement">case</span> <span class="Number">1</span>:
    <span class="Statement">case</span> <span class="Number">2</span>:
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">41</span>:                    <span class="Comment">/* ㄳ */</span>
        reg-&gt;jong = <span class="Number">3</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">3</span>:
        reg-&gt;jong = <span class="Number">4</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">42</span>:                    <span class="Comment">/* ㄵ */</span>
    <span class="Statement">case</span> <span class="Number">43</span>:                    <span class="Comment">/* ㄶ */</span>
        reg-&gt;jong -= <span class="Number">37</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">4</span>:
        reg-&gt;jong = <span class="Number">7</span>;
        <span class="Statement">break</span>;
    <span class="Comment">//5: ㄸ</span>
    <span class="Statement">case</span> <span class="Number">6</span>:
        reg-&gt;jong = <span class="Number">8</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">44</span>:                    <span class="Comment">/* ㄺ */</span>
    <span class="Statement">case</span> <span class="Number">45</span>:                    <span class="Comment">/* ㄻ */</span>
    <span class="Statement">case</span> <span class="Number">46</span>:                    <span class="Comment">/* ㄼ */</span>
    <span class="Statement">case</span> <span class="Number">47</span>:                    <span class="Comment">/* ㄽ */</span>
    <span class="Statement">case</span> <span class="Number">48</span>:                    <span class="Comment">/* ㄾ */</span>
    <span class="Statement">case</span> <span class="Number">49</span>:                    <span class="Comment">/* ㄿ */</span>
    <span class="Statement">case</span> <span class="Number">50</span>:                    <span class="Comment">/* ㅀ */</span>
        reg-&gt;jong -= <span class="Number">35</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">7</span>:
    <span class="Statement">case</span> <span class="Number">8</span>:
        reg-&gt;jong += <span class="Number">9</span>;
        <span class="Statement">break</span>;
    <span class="Comment">//9: ㅃ</span>
    <span class="Statement">case</span> <span class="Number">51</span>:                    <span class="Comment">/* ㅄ */</span>
        reg-&gt;jong = <span class="Number">18</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">10</span>:
    <span class="Statement">case</span> <span class="Number">11</span>:
    <span class="Statement">case</span> <span class="Number">12</span>:
    <span class="Statement">case</span> <span class="Number">13</span>:
        reg-&gt;jong += <span class="Number">9</span>;
        <span class="Statement">break</span>;
    <span class="Comment">//14: ㅉ</span>
    <span class="Statement">case</span> <span class="Number">15</span>:
    <span class="Statement">case</span> <span class="Number">16</span>:
    <span class="Statement">case</span> <span class="Number">17</span>:
    <span class="Statement">case</span> <span class="Number">18</span>:
    <span class="Statement">case</span> <span class="Number">19</span>:
        reg-&gt;jong += <span class="Number">8</span>;
    }
}


<span class="Type">void</span> han_dja(<span class="Type">char</span> chr, <span class="Type">unsigned</span> *cho_jong, han_reg *reg)
{
    <span class="Type">unsigned</span> buf = *cho_jong;
    <span class="Statement">switch</span> (buf) {
    <span class="Statement">case</span> <span class="Number">1</span>:                        <span class="Comment">/* ㄱ */</span>
        <span class="Statement">if</span> (chr == <span class="Constant">'t'</span>) {
            *cho_jong = <span class="Number">41</span>;        <span class="Comment">/* ㄳ */</span>
            <span class="Statement">return</span>;
        }
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">3</span>:                        <span class="Comment">/* ㄴ */</span>
        <span class="Statement">switch</span> (chr) {
        <span class="Statement">case</span> <span class="Constant">'w'</span>:                <span class="Comment">/* ㄵ */</span>
            *cho_jong = <span class="Number">42</span>;
            <span class="Statement">return</span>;
        <span class="Statement">case</span> <span class="Constant">'g'</span>:                <span class="Comment">/* ㄶ */</span>
            *cho_jong = <span class="Number">43</span>;
            <span class="Statement">return</span>;
        }
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">6</span>:                        <span class="Comment">/* ㄹ */</span>
        <span class="Statement">switch</span> (chr) {
        <span class="Statement">case</span> <span class="Constant">'r'</span>:                <span class="Comment">/* ㄺ */</span>
            *cho_jong = <span class="Number">44</span>;
            <span class="Statement">return</span>;
        <span class="Statement">case</span> <span class="Constant">'a'</span>:                <span class="Comment">/* ㄻ */</span>
            *cho_jong = <span class="Number">45</span>;
            <span class="Statement">return</span>;
        <span class="Statement">case</span> <span class="Constant">'q'</span>:                <span class="Comment">/* ㄼ */</span>
            *cho_jong = <span class="Number">46</span>;
            <span class="Statement">return</span>;
        <span class="Statement">case</span> <span class="Constant">'t'</span>:                <span class="Comment">/* ㄽ */</span>
            *cho_jong = <span class="Number">47</span>;
            <span class="Statement">return</span>;
        <span class="Statement">case</span> <span class="Constant">'x'</span>:                <span class="Comment">/* ㄾ */</span>
            *cho_jong = <span class="Number">48</span>;
            <span class="Statement">return</span>;
        <span class="Statement">case</span> <span class="Constant">'v'</span>:                <span class="Comment">/* ㄿ */</span>
            *cho_jong = <span class="Number">49</span>;
            <span class="Statement">return</span>;
        <span class="Statement">case</span> <span class="Constant">'g'</span>:                <span class="Comment">/* ㅀ */</span>
            *cho_jong = <span class="Number">49</span>;
            <span class="Statement">return</span>;
        }
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">8</span>:                        <span class="Comment">/* ㅂ */</span>
        <span class="Statement">if</span> (chr == <span class="Constant">'t'</span>) {
            *cho_jong = <span class="Number">51</span>;        <span class="Comment">/* ㅄ */</span>
            <span class="Statement">return</span>;
        }
        <span class="Statement">break</span>;
    }
    han_insert_p(reg);
    reg-&gt;cho = HAN_T(chr);
    <span class="Statement">return</span>;
}


<span class="Type">void</span> han_split_jong(<span class="Type">char</span> chr, han_reg *reg)
{
    <span class="Type">unsigned</span> buffer;
    <span class="Statement">if</span> (reg-&gt;jong &gt;= <span class="Number">41</span>)
        buffer = han_break(&amp;(reg-&gt;jong));
    <span class="Statement">else</span> {
        buffer = reg-&gt;jong;
        reg-&gt;jong = <span class="Number">0</span>;
    }

    han_insert_p(reg);
    reg-&gt;cho = buffer;
    reg-&gt;jung = HAN_T(chr);
}


<span class="Type">unsigned</span> han_break(<span class="Type">unsigned</span> *cho_jong)
{
    <span class="Type">unsigned</span> ret;

    <span class="Statement">switch</span> (*cho_jong) {
    <span class="Statement">case</span> <span class="Number">41</span>:                <span class="Comment">/* ㄳ */</span>
        *cho_jong = <span class="Number">1</span>;
        ret = <span class="Number">10</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">42</span>:                <span class="Comment">/* ㄵ */</span>
        *cho_jong = <span class="Number">3</span>;
        ret = <span class="Number">13</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">43</span>:                <span class="Comment">/* ㄶ */</span>
        *cho_jong = <span class="Number">3</span>;
        ret = <span class="Number">19</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">44</span>:                <span class="Comment">/* ㄺ */</span>
        *cho_jong = <span class="Number">6</span>;
        ret = <span class="Number">1</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">45</span>:                <span class="Comment">/* ㄻ */</span>
        *cho_jong = <span class="Number">6</span>;
        ret = <span class="Number">7</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">46</span>:                <span class="Comment">/* ㄼ */</span>
        *cho_jong = <span class="Number">6</span>;
        ret = <span class="Number">8</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">47</span>:                <span class="Comment">/* ㄽ */</span>
        *cho_jong = <span class="Number">6</span>;
        ret = <span class="Number">10</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">48</span>:                <span class="Comment">/* ㄾ */</span>
        *cho_jong = <span class="Number">6</span>;
        ret = <span class="Number">17</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">49</span>:                <span class="Comment">/* ㄿ */</span>
        *cho_jong = <span class="Number">6</span>;
        ret = <span class="Number">18</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">50</span>:                <span class="Comment">/* ㅀ */</span>
        *cho_jong = <span class="Number">6</span>;
        ret = <span class="Number">19</span>;
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">51</span>:                <span class="Comment">/* ㅄ */</span>
        *cho_jong = <span class="Number">8</span>;
        ret = <span class="Number">10</span>;
        <span class="Statement">break</span>;
    }

    <span class="Statement">return</span> ret;
}


<span class="Type">void</span> han_dmo(<span class="Type">char</span> chr, han_reg *reg)
{
    <span class="Statement">switch</span> (reg-&gt;jung) {
    <span class="Statement">case</span> <span class="Number">28</span>:                    <span class="Comment">/* ㅗ */</span>
        <span class="Statement">switch</span> (chr) {
        <span class="Statement">case</span> <span class="Constant">'k'</span>:                <span class="Comment">/* ㅘ */</span>
            reg-&gt;jung = <span class="Number">29</span>;
            <span class="Statement">break</span>;
        <span class="Statement">case</span> <span class="Constant">'o'</span>:                <span class="Comment">/* ㅙ */</span>
            reg-&gt;jung = <span class="Number">30</span>;
            <span class="Statement">break</span>;
        <span class="Statement">case</span> <span class="Constant">'l'</span>:                <span class="Comment">/* ㅚ */</span>
            reg-&gt;jung = <span class="Number">31</span>;
            <span class="Statement">break</span>;
        }
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">33</span>:                    <span class="Comment">/* ㅜ */</span>
        <span class="Statement">switch</span> (chr) {
        <span class="Statement">case</span> <span class="Constant">'j'</span>:                <span class="Comment">/* ㅝ */</span>
            reg-&gt;jung = <span class="Number">34</span>;
            <span class="Statement">break</span>;
        <span class="Statement">case</span> <span class="Constant">'p'</span>:                <span class="Comment">/* ㅞ */</span>
            reg-&gt;jung = <span class="Number">35</span>;
            <span class="Statement">break</span>;
        <span class="Statement">case</span> <span class="Constant">'l'</span>:                <span class="Comment">/* ㅟ */</span>
            reg-&gt;jung = <span class="Number">36</span>;
            <span class="Statement">break</span>;
        }
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">38</span>:                    <span class="Comment">/* ㅡ */</span>
        <span class="Statement">if</span> (chr == <span class="Constant">'l'</span>)
            reg-&gt;jung = <span class="Number">39</span>;        <span class="Comment">/* ㅢ */</span>
        <span class="Statement">break</span>;
    <span class="Statement">default</span>:
        han_insert_p(reg);
        reg-&gt;jung = HAN_T(chr);
    }

}


<span class="Type">unsigned</span> han_check_reg(han_reg *reg)
{
    <span class="Statement">if</span> (reg-&gt;cho != <span class="Number">0</span>) {
        <span class="Statement">if</span> (reg-&gt;jung != <span class="Number">0</span>)
            <span class="Statement">return</span> (reg-&gt;jong) ? <span class="Number">1</span> : <span class="Number">2</span>;
        <span class="Statement">else</span>
            <span class="Statement">return</span> <span class="Number">3</span>;
    } <span class="Statement">else</span> {
        <span class="Statement">return</span> (reg-&gt;jung != <span class="Number">0</span>) ? <span class="Number">4</span> : <span class="Number">5</span>;
    }
}


<span class="Type">void</span> han_ja(<span class="Type">char</span> chr, han_reg *reg)
{
    <span class="Statement">switch</span> (han_check_reg(reg)) {
    <span class="Statement">case</span> <span class="Number">1</span>:
        han_dja(chr, &amp;(reg-&gt;jong), reg);
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">2</span>:
        reg-&gt;jong = HAN_T(chr);
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">3</span>:
        han_dja(chr, &amp;(reg-&gt;cho), reg);
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">4</span>:
        han_insert_p(reg);
        han_print_p(reg);
    <span class="Statement">case</span> <span class="Number">5</span>:
        reg-&gt;cho = HAN_T(chr);
        <span class="Statement">break</span>;
    }
}


<span class="Type">void</span> han_mo(<span class="Type">char</span> chr, han_reg *reg)
{
    <span class="Statement">switch</span> (han_check_reg(reg)) {
    <span class="Statement">case</span> <span class="Number">1</span>:
        han_split_jong(chr, reg);
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">2</span>:
    <span class="Statement">case</span> <span class="Number">4</span>:
        han_dmo(chr, reg);
        <span class="Statement">break</span>;
    <span class="Statement">case</span> <span class="Number">3</span>:
        <span class="Statement">if</span> (reg-&gt;cho &gt;= <span class="Number">41</span>) {
            <span class="Type">unsigned</span> buffer = han_break(&amp;(reg-&gt;cho));
            han_insert_p(reg);
            reg-&gt;cho = buffer;
            reg-&gt;jung = HAN_T(chr);
        }
    <span class="Statement">case</span> <span class="Number">5</span>:
        reg-&gt;jung = HAN_T(chr);
        <span class="Statement">break</span>;
    }
}


<span class="Type">void</span> han(<span class="Type">wchar_t</span> *str, han_reg *reg)
{
    <span class="Statement">for</span> (<span class="Type">int</span> i=<span class="Number">0</span>; str[i] != <span class="Special">'\0'</span>; i++) {
        <span class="Statement">if</span> (reg-&gt;p)
            han_print_p(reg);

        <span class="Statement">if</span> (str[i]&lt;<span class="Constant">'A'</span> || str[i]&gt;<span class="Constant">'z'</span>) {
            <span class="Statement">if</span> (reg-&gt;cho || reg-&gt;jung) {
                han_insert_p(reg);
                han_print_p(reg);
            }
            putwchar(str[i]);
        }
        <span class="Statement">else</span>
            han_trans(str[i], reg);
    }

    han_insert_p(reg);
    han_print_p(reg);
}


<span class="Type">int</span> main(<span class="Type">void</span>)
{
    setlocale(<span class="Constant">LC_ALL</span>, <span class="String">&quot;&quot;</span>);
    <span class="Type">wchar_t</span> buffer[BUFSIZE];
    han_reg reg = {};

    <span class="Statement">while</span> (fgetws(buffer, BUFSIZE, <span class="Constant">stdin</span>) != <span class="Constant">NULL</span>)
        han(buffer, &amp;reg);

    <span class="Statement">return</span> <span class="Number">0</span>;
}

</pre>
</body>
</html>
